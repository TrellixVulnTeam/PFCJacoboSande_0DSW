{"ast":null,"code":"import { __assign, __decorate, __extends } from \"tslib\";\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { Fabric } from '../../Fabric';\nimport { classNamesFunction, customizable, getDocument, setPortalAttribute, setVirtualParent, warnDeprecations } from '../../Utilities';\nimport { registerLayer, getDefaultTarget, unregisterLayer } from './Layer.notification';\nvar getClassNames = classNamesFunction();\n\nvar LayerBase =\n/** @class */\nfunction (_super) {\n  __extends(LayerBase, _super);\n\n  function LayerBase(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this._rootRef = React.createRef();\n\n    _this._createLayerElement = function () {\n      var hostId = _this.props.hostId;\n      var doc = getDocument(_this._rootRef.current);\n\n      var host = _this._getHost();\n\n      if (!doc || !host) {\n        return;\n      } // If one was already existing, remove.\n\n\n      _this._removeLayerElement();\n\n      var layerElement = doc.createElement('div');\n\n      var classNames = _this._getClassNames();\n\n      layerElement.className = classNames.root;\n      setPortalAttribute(layerElement);\n      setVirtualParent(layerElement, _this._rootRef.current);\n      _this.props.insertFirst ? host.insertBefore(layerElement, host.firstChild) : host.appendChild(layerElement);\n\n      _this.setState({\n        hostId: hostId,\n        layerElement: layerElement\n      }, function () {\n        // eslint-disable-next-line deprecation/deprecation\n        var _a = _this.props,\n            onLayerDidMount = _a.onLayerDidMount,\n            onLayerMounted = _a.onLayerMounted;\n\n        if (onLayerMounted) {\n          onLayerMounted();\n        }\n\n        if (onLayerDidMount) {\n          onLayerDidMount();\n        }\n      });\n    };\n\n    _this.state = {};\n\n    if (process.env.NODE_ENV !== 'production') {\n      warnDeprecations('Layer', props, {\n        onLayerMounted: 'onLayerDidMount'\n      });\n    }\n\n    return _this;\n  }\n\n  LayerBase.prototype.componentDidMount = function () {\n    var hostId = this.props.hostId;\n\n    this._createLayerElement();\n\n    if (hostId) {\n      registerLayer(hostId, this._createLayerElement);\n    }\n  };\n\n  LayerBase.prototype.render = function () {\n    var layerElement = this.state.layerElement;\n\n    var classNames = this._getClassNames();\n\n    var eventBubblingEnabled = this.props.eventBubblingEnabled;\n    return React.createElement(\"span\", {\n      className: \"ms-layer\",\n      ref: this._rootRef\n    }, layerElement && ReactDOM.createPortal(React.createElement(Fabric, __assign({}, !eventBubblingEnabled && _getFilteredEvents(), {\n      className: classNames.content\n    }), this.props.children), layerElement));\n  };\n\n  LayerBase.prototype.componentDidUpdate = function () {\n    if (this.props.hostId !== this.state.hostId) {\n      this._createLayerElement();\n    }\n  };\n\n  LayerBase.prototype.componentWillUnmount = function () {\n    var hostId = this.props.hostId;\n\n    this._removeLayerElement();\n\n    if (hostId) {\n      unregisterLayer(hostId, this._createLayerElement);\n    }\n  };\n\n  LayerBase.prototype._removeLayerElement = function () {\n    var onLayerWillUnmount = this.props.onLayerWillUnmount;\n    var layerElement = this.state.layerElement;\n\n    if (layerElement) {\n      setVirtualParent(layerElement, null);\n    }\n\n    if (onLayerWillUnmount) {\n      onLayerWillUnmount();\n    }\n\n    if (layerElement && layerElement.parentNode) {\n      var parentNode = layerElement.parentNode;\n\n      if (parentNode) {\n        parentNode.removeChild(layerElement);\n      }\n    }\n  };\n\n  LayerBase.prototype._getClassNames = function () {\n    var _a = this.props,\n        className = _a.className,\n        styles = _a.styles,\n        theme = _a.theme;\n    var classNames = getClassNames(styles, {\n      theme: theme,\n      className: className,\n      isNotHost: !this.props.hostId\n    });\n    return classNames;\n  };\n\n  LayerBase.prototype._getHost = function () {\n    var hostId = this.props.hostId;\n    var doc = getDocument(this._rootRef.current);\n\n    if (!doc) {\n      return undefined;\n    }\n\n    if (hostId) {\n      return doc.getElementById(hostId);\n    } else {\n      var defaultHostSelector = getDefaultTarget();\n      return defaultHostSelector ? doc.querySelector(defaultHostSelector) : doc.body;\n    }\n  };\n\n  LayerBase.defaultProps = {\n    onLayerDidMount: function onLayerDidMount() {\n      return undefined;\n    },\n    onLayerWillUnmount: function onLayerWillUnmount() {\n      return undefined;\n    }\n  };\n  LayerBase = __decorate([customizable('Layer', ['theme', 'hostId'])], LayerBase);\n  return LayerBase;\n}(React.Component);\n\nexport { LayerBase };\n\nvar _onFilterEvent = function _onFilterEvent(ev) {\n  // We should just be able to check ev.bubble here and only stop events that are bubbling up. However, even though\n  // mouseenter and mouseleave do NOT bubble up, they are showing up as bubbling. Therefore we stop events based on\n  // event name rather than ev.bubble.\n  if (ev.eventPhase === Event.BUBBLING_PHASE && ev.type !== 'mouseenter' && ev.type !== 'mouseleave' && ev.type !== 'touchstart' && ev.type !== 'touchend') {\n    ev.stopPropagation();\n  }\n};\n\nvar _filteredEventProps;\n\nfunction _getFilteredEvents() {\n  if (!_filteredEventProps) {\n    _filteredEventProps = {};\n    ['onClick', 'onContextMenu', 'onDoubleClick', 'onDrag', 'onDragEnd', 'onDragEnter', 'onDragExit', 'onDragLeave', 'onDragOver', 'onDragStart', 'onDrop', 'onMouseDown', 'onMouseEnter', 'onMouseLeave', 'onMouseMove', 'onMouseOver', 'onMouseOut', 'onMouseUp', 'onTouchMove', 'onTouchStart', 'onTouchCancel', 'onTouchEnd', 'onKeyDown', 'onKeyPress', 'onKeyUp', 'onFocus', 'onBlur', 'onChange', 'onInput', 'onInvalid', 'onSubmit'].forEach(function (name) {\n      return _filteredEventProps[name] = _onFilterEvent;\n    });\n  }\n\n  return _filteredEventProps;\n}","map":{"version":3,"mappings":"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","names":["React","ReactDOM","Fabric","classNamesFunction","customizable","getDocument","setPortalAttribute","setVirtualParent","warnDeprecations","registerLayer","getDefaultTarget","unregisterLayer","getClassNames","__extends","props","_super","_this","createRef","doc","_rootRef","current","host","_getHost","_removeLayerElement","layerElement","createElement","classNames","_getClassNames","className","root","insertFirst","insertBefore","firstChild","appendChild","setState","hostId","onLayerDidMount","onLayerMounted","state","process","env","NODE_ENV","LayerBase","_createLayerElement","ref","createPortal","__assign","eventBubblingEnabled","_getFilteredEvents","content","children","onLayerWillUnmount","parentNode","removeChild","styles","theme","isNotHost","undefined","getElementById","defaultHostSelector","querySelector","body","Component","_onFilterEvent","ev","eventPhase","Event","BUBBLING_PHASE","type","stopPropagation","_filteredEventProps","forEach","name"],"sources":["D:\\PFCJACOBO\\PFC\\mycinemalist\\node_modules\\office-ui-fabric-react\\lib\\components\\src\\components\\Layer\\Layer.base.tsx"],"sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\n\nimport { Fabric } from '../../Fabric';\nimport { ILayerProps, ILayerStyleProps, ILayerStyles } from './Layer.types';\nimport {\n  classNamesFunction,\n  customizable,\n  getDocument,\n  setPortalAttribute,\n  setVirtualParent,\n  warnDeprecations,\n} from '../../Utilities';\nimport { registerLayer, getDefaultTarget, unregisterLayer } from './Layer.notification';\n\nexport type ILayerBaseState = {\n  hostId?: string;\n  layerElement?: HTMLElement;\n};\n\nconst getClassNames = classNamesFunction<ILayerStyleProps, ILayerStyles>();\n\n@customizable('Layer', ['theme', 'hostId'])\nexport class LayerBase extends React.Component<ILayerProps, ILayerBaseState> {\n  public static defaultProps: ILayerProps = {\n    onLayerDidMount: () => undefined,\n    onLayerWillUnmount: () => undefined,\n  };\n\n  private _rootRef = React.createRef<HTMLSpanElement>();\n\n  constructor(props: ILayerProps) {\n    super(props);\n\n    this.state = {};\n\n    if (process.env.NODE_ENV !== 'production') {\n      warnDeprecations('Layer', props, {\n        onLayerMounted: 'onLayerDidMount',\n      });\n    }\n  }\n\n  public componentDidMount(): void {\n    const { hostId } = this.props;\n\n    this._createLayerElement();\n\n    if (hostId) {\n      registerLayer(hostId, this._createLayerElement);\n    }\n  }\n\n  public render(): React.ReactNode {\n    const { layerElement } = this.state;\n    const classNames = this._getClassNames();\n    const { eventBubblingEnabled } = this.props;\n\n    return (\n      <span className=\"ms-layer\" ref={this._rootRef}>\n        {layerElement &&\n          ReactDOM.createPortal(\n            <Fabric {...(!eventBubblingEnabled && _getFilteredEvents())} className={classNames.content}>\n              {this.props.children}\n            </Fabric>,\n            layerElement,\n          )}\n      </span>\n    );\n  }\n\n  public componentDidUpdate(): void {\n    if (this.props.hostId !== this.state.hostId) {\n      this._createLayerElement();\n    }\n  }\n\n  public componentWillUnmount(): void {\n    const { hostId } = this.props;\n\n    this._removeLayerElement();\n    if (hostId) {\n      unregisterLayer(hostId, this._createLayerElement);\n    }\n  }\n\n  private _createLayerElement = () => {\n    const { hostId } = this.props;\n\n    const doc = getDocument(this._rootRef.current);\n    const host = this._getHost();\n\n    if (!doc || !host) {\n      return;\n    }\n\n    // If one was already existing, remove.\n    this._removeLayerElement();\n\n    const layerElement = doc.createElement('div');\n    const classNames = this._getClassNames();\n\n    layerElement.className = classNames.root!;\n    setPortalAttribute(layerElement);\n    setVirtualParent(layerElement, this._rootRef.current!);\n\n    this.props.insertFirst ? host.insertBefore(layerElement, host.firstChild) : host.appendChild(layerElement);\n\n    this.setState(\n      {\n        hostId,\n        layerElement,\n      },\n      () => {\n        // eslint-disable-next-line deprecation/deprecation\n        const { onLayerDidMount, onLayerMounted } = this.props;\n        if (onLayerMounted) {\n          onLayerMounted();\n        }\n\n        if (onLayerDidMount) {\n          onLayerDidMount();\n        }\n      },\n    );\n  };\n\n  private _removeLayerElement(): void {\n    const { onLayerWillUnmount } = this.props;\n    const { layerElement } = this.state;\n\n    if (layerElement) {\n      setVirtualParent(layerElement, null);\n    }\n\n    if (onLayerWillUnmount) {\n      onLayerWillUnmount();\n    }\n\n    if (layerElement && layerElement.parentNode) {\n      const parentNode = layerElement.parentNode;\n      if (parentNode) {\n        parentNode.removeChild(layerElement);\n      }\n    }\n  }\n\n  private _getClassNames() {\n    const { className, styles, theme } = this.props;\n    const classNames = getClassNames(styles!, {\n      theme: theme!,\n      className,\n      isNotHost: !this.props.hostId,\n    });\n\n    return classNames;\n  }\n\n  private _getHost(): Node | undefined {\n    const { hostId } = this.props;\n    const doc = getDocument(this._rootRef.current);\n    if (!doc) {\n      return undefined;\n    }\n\n    if (hostId) {\n      return doc.getElementById(hostId) as Node;\n    } else {\n      const defaultHostSelector = getDefaultTarget();\n      return defaultHostSelector ? (doc.querySelector(defaultHostSelector) as Node) : doc.body;\n    }\n  }\n}\n\nconst _onFilterEvent = (ev: React.SyntheticEvent<HTMLElement>): void => {\n  // We should just be able to check ev.bubble here and only stop events that are bubbling up. However, even though\n  // mouseenter and mouseleave do NOT bubble up, they are showing up as bubbling. Therefore we stop events based on\n  // event name rather than ev.bubble.\n  if (\n    ev.eventPhase === Event.BUBBLING_PHASE &&\n    ev.type !== 'mouseenter' &&\n    ev.type !== 'mouseleave' &&\n    ev.type !== 'touchstart' &&\n    ev.type !== 'touchend'\n  ) {\n    ev.stopPropagation();\n  }\n};\n\nlet _filteredEventProps: { [key: string]: (ev: React.SyntheticEvent<HTMLElement, Event>) => void };\n\nfunction _getFilteredEvents() {\n  if (!_filteredEventProps) {\n    _filteredEventProps = {} as any;\n\n    [\n      'onClick',\n      'onContextMenu',\n      'onDoubleClick',\n      'onDrag',\n      'onDragEnd',\n      'onDragEnter',\n      'onDragExit',\n      'onDragLeave',\n      'onDragOver',\n      'onDragStart',\n      'onDrop',\n      'onMouseDown',\n      'onMouseEnter',\n      'onMouseLeave',\n      'onMouseMove',\n      'onMouseOver',\n      'onMouseOut',\n      'onMouseUp',\n      'onTouchMove',\n      'onTouchStart',\n      'onTouchCancel',\n      'onTouchEnd',\n      'onKeyDown',\n      'onKeyPress',\n      'onKeyUp',\n      'onFocus',\n      'onBlur',\n      'onChange',\n      'onInput',\n      'onInvalid',\n      'onSubmit',\n    ].forEach(name => (_filteredEventProps[name] = _onFilterEvent));\n  }\n\n  return _filteredEventProps;\n}\n"]},"metadata":{},"sourceType":"module"}