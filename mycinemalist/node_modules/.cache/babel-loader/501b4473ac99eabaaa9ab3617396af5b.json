{"ast":null,"code":"/*!\n * HTML5 export buttons for Buttons and DataTables.\n * 2016 SpryMedia Ltd - datatables.net/license\n *\n * FileSaver.js (1.3.3) - MIT license\n * Copyright © 2016 Eli Grey - http://eligrey.com\n */\n(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['jquery', 'datatables.net', 'datatables.net-buttons'], function ($) {\n      return factory($, window, document);\n    });\n  } else if (typeof exports === 'object') {\n    // CommonJS\n    module.exports = function (root, $, jszip, pdfmake) {\n      if (!root) {\n        root = window;\n      }\n\n      if (!$ || !$.fn.dataTable) {\n        $ = require('datatables.net')(root, $).$;\n      }\n\n      if (!$.fn.dataTable.Buttons) {\n        require('datatables.net-buttons')(root, $);\n      }\n\n      return factory($, root, root.document, jszip, pdfmake);\n    };\n  } else {\n    // Browser\n    factory(jQuery, window, document);\n  }\n})(function ($, window, document, jszip, pdfmake, undefined) {\n  'use strict';\n\n  var DataTable = $.fn.dataTable; // Allow the constructor to pass in JSZip and PDFMake from external requires.\n  // Otherwise, use globally defined variables, if they are available.\n\n  function _jsZip() {\n    return jszip || window.JSZip;\n  }\n\n  function _pdfMake() {\n    return pdfmake || window.pdfMake;\n  }\n\n  DataTable.Buttons.pdfMake = function (_) {\n    if (!_) {\n      return _pdfMake();\n    }\n\n    pdfmake = _;\n  };\n\n  DataTable.Buttons.jszip = function (_) {\n    if (!_) {\n      return _jsZip();\n    }\n\n    jszip = _;\n  };\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * FileSaver.js dependency\n   */\n\n  /*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n\n  var _saveAs = function (view) {\n    \"use strict\"; // IE <10 is explicitly unsupported\n\n    if (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n      return;\n    }\n\n    var doc = view.document // only get URL when necessary in case Blob.js hasn't overridden it yet\n    ,\n        get_URL = function () {\n      return view.URL || view.webkitURL || view;\n    },\n        save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\"),\n        can_use_save_link = (\"download\" in save_link),\n        click = function (node) {\n      var event = new MouseEvent(\"click\");\n      node.dispatchEvent(event);\n    },\n        is_safari = /constructor/i.test(view.HTMLElement) || view.safari,\n        is_chrome_ios = /CriOS\\/[\\d]+/.test(navigator.userAgent),\n        throw_outside = function (ex) {\n      (view.setImmediate || view.setTimeout)(function () {\n        throw ex;\n      }, 0);\n    },\n        force_saveable_type = \"application/octet-stream\" // the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n    ,\n        arbitrary_revoke_timeout = 1000 * 40 // in ms\n    ,\n        revoke = function (file) {\n      var revoker = function () {\n        if (typeof file === \"string\") {\n          // file is an object URL\n          get_URL().revokeObjectURL(file);\n        } else {\n          // file is a File\n          file.remove();\n        }\n      };\n\n      setTimeout(revoker, arbitrary_revoke_timeout);\n    },\n        dispatch = function (filesaver, event_types, event) {\n      event_types = [].concat(event_types);\n      var i = event_types.length;\n\n      while (i--) {\n        var listener = filesaver[\"on\" + event_types[i]];\n\n        if (typeof listener === \"function\") {\n          try {\n            listener.call(filesaver, event || filesaver);\n          } catch (ex) {\n            throw_outside(ex);\n          }\n        }\n      }\n    },\n        auto_bom = function (blob) {\n      // prepend BOM for UTF-8 XML and text/* types (including HTML)\n      // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n      if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n        return new Blob([String.fromCharCode(0xFEFF), blob], {\n          type: blob.type\n        });\n      }\n\n      return blob;\n    },\n        FileSaver = function (blob, name, no_auto_bom) {\n      if (!no_auto_bom) {\n        blob = auto_bom(blob);\n      } // First try a.download, then web filesystem, then object URLs\n\n\n      var filesaver = this,\n          type = blob.type,\n          force = type === force_saveable_type,\n          object_url,\n          dispatch_all = function () {\n        dispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n      } // on any filesys errors revert to saving with object URLs\n      ,\n          fs_error = function () {\n        if ((is_chrome_ios || force && is_safari) && view.FileReader) {\n          // Safari doesn't allow downloading of blob urls\n          var reader = new FileReader();\n\n          reader.onloadend = function () {\n            var url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n            var popup = view.open(url, '_blank');\n            if (!popup) view.location.href = url;\n            url = undefined; // release reference before dispatching\n\n            filesaver.readyState = filesaver.DONE;\n            dispatch_all();\n          };\n\n          reader.readAsDataURL(blob);\n          filesaver.readyState = filesaver.INIT;\n          return;\n        } // don't create more object URLs than needed\n\n\n        if (!object_url) {\n          object_url = get_URL().createObjectURL(blob);\n        }\n\n        if (force) {\n          view.location.href = object_url;\n        } else {\n          var opened = view.open(object_url, \"_blank\");\n\n          if (!opened) {\n            // Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n            view.location.href = object_url;\n          }\n        }\n\n        filesaver.readyState = filesaver.DONE;\n        dispatch_all();\n        revoke(object_url);\n      };\n\n      filesaver.readyState = filesaver.INIT;\n\n      if (can_use_save_link) {\n        object_url = get_URL().createObjectURL(blob);\n        setTimeout(function () {\n          save_link.href = object_url;\n          save_link.download = name;\n          click(save_link);\n          dispatch_all();\n          revoke(object_url);\n          filesaver.readyState = filesaver.DONE;\n        });\n        return;\n      }\n\n      fs_error();\n    },\n        FS_proto = FileSaver.prototype,\n        saveAs = function (blob, name, no_auto_bom) {\n      return new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n    }; // IE 10+ (native saveAs)\n\n\n    if (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n      return function (blob, name, no_auto_bom) {\n        name = name || blob.name || \"download\";\n\n        if (!no_auto_bom) {\n          blob = auto_bom(blob);\n        }\n\n        return navigator.msSaveOrOpenBlob(blob, name);\n      };\n    }\n\n    FS_proto.abort = function () {};\n\n    FS_proto.readyState = FS_proto.INIT = 0;\n    FS_proto.WRITING = 1;\n    FS_proto.DONE = 2;\n    FS_proto.error = FS_proto.onwritestart = FS_proto.onprogress = FS_proto.onwrite = FS_proto.onabort = FS_proto.onerror = FS_proto.onwriteend = null;\n    return saveAs;\n  }(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content); // Expose file saver on the DataTables API. Can't attach to `DataTables.Buttons`\n  // since this file can be loaded before Button's core!\n\n\n  DataTable.fileSave = _saveAs;\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * Local (private) functions\n   */\n\n  /**\n   * Get the sheet name for Excel exports.\n   *\n   * @param {object}\tconfig Button configuration\n   */\n\n  var _sheetname = function (config) {\n    var sheetName = 'Sheet1';\n\n    if (config.sheetName) {\n      sheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n    }\n\n    return sheetName;\n  };\n  /**\n   * Get the newline character(s)\n   *\n   * @param {object}\tconfig Button configuration\n   * @return {string}\t\t\t\tNewline character\n   */\n\n\n  var _newLine = function (config) {\n    return config.newline ? config.newline : navigator.userAgent.match(/Windows/) ? '\\r\\n' : '\\n';\n  };\n  /**\n   * Combine the data from the `buttons.exportData` method into a string that\n   * will be used in the export file.\n   *\n   * @param\t{DataTable.Api} dt\t\t DataTables API instance\n   * @param\t{object}\t\t\t\tconfig Button configuration\n   * @return {object}\t\t\t\t\t\t\t The data to export\n   */\n\n\n  var _exportData = function (dt, config) {\n    var newLine = _newLine(config);\n\n    var data = dt.buttons.exportData(config.exportOptions);\n    var boundary = config.fieldBoundary;\n    var separator = config.fieldSeparator;\n    var reBoundary = new RegExp(boundary, 'g');\n    var escapeChar = config.escapeChar !== undefined ? config.escapeChar : '\\\\';\n\n    var join = function (a) {\n      var s = ''; // If there is a field boundary, then we might need to escape it in\n      // the source data\n\n      for (var i = 0, ien = a.length; i < ien; i++) {\n        if (i > 0) {\n          s += separator;\n        }\n\n        s += boundary ? boundary + ('' + a[i]).replace(reBoundary, escapeChar + boundary) + boundary : a[i];\n      }\n\n      return s;\n    };\n\n    var header = config.header ? join(data.header) + newLine : '';\n    var footer = config.footer && data.footer ? newLine + join(data.footer) : '';\n    var body = [];\n\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      body.push(join(data.body[i]));\n    }\n\n    return {\n      str: header + body.join(newLine) + footer,\n      rows: body.length\n    };\n  };\n  /**\n   * Older versions of Safari (prior to tech preview 18) don't support the\n   * download option required.\n   *\n   * @return {Boolean} `true` if old Safari\n   */\n\n\n  var _isDuffSafari = function () {\n    var safari = navigator.userAgent.indexOf('Safari') !== -1 && navigator.userAgent.indexOf('Chrome') === -1 && navigator.userAgent.indexOf('Opera') === -1;\n\n    if (!safari) {\n      return false;\n    }\n\n    var version = navigator.userAgent.match(/AppleWebKit\\/(\\d+\\.\\d+)/);\n\n    if (version && version.length > 1 && version[1] * 1 < 603.1) {\n      return true;\n    }\n\n    return false;\n  };\n  /**\n   * Convert from numeric position to letter for column names in Excel\n   * @param  {int} n Column number\n   * @return {string} Column letter(s) name\n   */\n\n\n  function createCellPos(n) {\n    var ordA = 'A'.charCodeAt(0);\n    var ordZ = 'Z'.charCodeAt(0);\n    var len = ordZ - ordA + 1;\n    var s = \"\";\n\n    while (n >= 0) {\n      s = String.fromCharCode(n % len + ordA) + s;\n      n = Math.floor(n / len) - 1;\n    }\n\n    return s;\n  }\n\n  try {\n    var _serialiser = new XMLSerializer();\n\n    var _ieExcel;\n  } catch (t) {}\n  /**\n   * Recursively add XML files from an object's structure to a ZIP file. This\n   * allows the XSLX file to be easily defined with an object's structure matching\n   * the files structure.\n   *\n   * @param {JSZip} zip ZIP package\n   * @param {object} obj Object to add (recursive)\n   */\n\n\n  function _addToZip(zip, obj) {\n    if (_ieExcel === undefined) {\n      // Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n      // drop attributes\n      _ieExcel = _serialiser.serializeToString(new window.DOMParser().parseFromString(excelStrings['xl/worksheets/sheet1.xml'], 'text/xml')).indexOf('xmlns:r') === -1;\n    }\n\n    $.each(obj, function (name, val) {\n      if ($.isPlainObject(val)) {\n        var newDir = zip.folder(name);\n\n        _addToZip(newDir, val);\n      } else {\n        if (_ieExcel) {\n          // IE's XML serialiser will drop some name space attributes from\n          // from the root node, so we need to save them. Do this by\n          // replacing the namespace nodes with a regular attribute that\n          // we convert back when serialised. Edge does not have this\n          // issue\n          var worksheet = val.childNodes[0];\n          var i, ien;\n          var attrs = [];\n\n          for (i = worksheet.attributes.length - 1; i >= 0; i--) {\n            var attrName = worksheet.attributes[i].nodeName;\n            var attrValue = worksheet.attributes[i].nodeValue;\n\n            if (attrName.indexOf(':') !== -1) {\n              attrs.push({\n                name: attrName,\n                value: attrValue\n              });\n              worksheet.removeAttribute(attrName);\n            }\n          }\n\n          for (i = 0, ien = attrs.length; i < ien; i++) {\n            var attr = val.createAttribute(attrs[i].name.replace(':', '_dt_b_namespace_token_'));\n            attr.value = attrs[i].value;\n            worksheet.setAttributeNode(attr);\n          }\n        }\n\n        var str = _serialiser.serializeToString(val); // Fix IE's XML\n\n\n        if (_ieExcel) {\n          // IE doesn't include the XML declaration\n          if (str.indexOf('<?xml') === -1) {\n            str = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + str;\n          } // Return namespace attributes to being as such\n\n\n          str = str.replace(/_dt_b_namespace_token_/g, ':'); // Remove testing name space that IE puts into the space preserve attr\n\n          str = str.replace(/xmlns:NS[\\d]+=\"\" NS[\\d]+:/g, '');\n        } // Safari, IE and Edge will put empty name space attributes onto\n        // various elements making them useless. This strips them out\n\n\n        str = str.replace(/<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>');\n        zip.file(name, str);\n      }\n    });\n  }\n  /**\n   * Create an XML node and add any children, attributes, etc without needing to\n   * be verbose in the DOM.\n   *\n   * @param  {object} doc      XML document\n   * @param  {string} nodeName Node name\n   * @param  {object} opts     Options - can be `attr` (attributes), `children`\n   *   (child nodes) and `text` (text content)\n   * @return {node}            Created node\n   */\n\n\n  function _createNode(doc, nodeName, opts) {\n    var tempNode = doc.createElement(nodeName);\n\n    if (opts) {\n      if (opts.attr) {\n        $(tempNode).attr(opts.attr);\n      }\n\n      if (opts.children) {\n        $.each(opts.children, function (key, value) {\n          tempNode.appendChild(value);\n        });\n      }\n\n      if (opts.text !== null && opts.text !== undefined) {\n        tempNode.appendChild(doc.createTextNode(opts.text));\n      }\n    }\n\n    return tempNode;\n  }\n  /**\n   * Get the width for an Excel column based on the contents of that column\n   * @param  {object} data Data for export\n   * @param  {int}    col  Column index\n   * @return {int}         Column width\n   */\n\n\n  function _excelColWidth(data, col) {\n    var max = data.header[col].length;\n    var len, lineSplit, str;\n\n    if (data.footer && data.footer[col].length > max) {\n      max = data.footer[col].length;\n    }\n\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      var point = data.body[i][col];\n      str = point !== null && point !== undefined ? point.toString() : ''; // If there is a newline character, workout the width of the column\n      // based on the longest line in the string\n\n      if (str.indexOf('\\n') !== -1) {\n        lineSplit = str.split('\\n');\n        lineSplit.sort(function (a, b) {\n          return b.length - a.length;\n        });\n        len = lineSplit[0].length;\n      } else {\n        len = str.length;\n      }\n\n      if (len > max) {\n        max = len;\n      } // Max width rather than having potentially massive column widths\n\n\n      if (max > 40) {\n        return 54; // 40 * 1.35\n      }\n    }\n\n    max *= 1.35; // And a min width\n\n    return max > 6 ? max : 6;\n  } // Excel - Pre-defined strings to build a basic XLSX file\n\n\n  var excelStrings = {\n    \"_rels/.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>' + '</Relationships>',\n    \"xl/_rels/workbook.xml.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>' + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' + '</Relationships>',\n    \"[Content_Types].xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' + '<Default Extension=\"xml\" ContentType=\"application/xml\" />' + '<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />' + '<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />' + '<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />' + '<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />' + '<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />' + '</Types>',\n    \"xl/workbook.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">' + '<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>' + '<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>' + '<bookViews>' + '<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>' + '</bookViews>' + '<sheets>' + '<sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\"/>' + '</sheets>' + '<definedNames/>' + '</workbook>',\n    \"xl/worksheets/sheet1.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<sheetData/>' + '<mergeCells count=\"0\"/>' + '</worksheet>',\n    \"xl/styles.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' + '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<numFmts count=\"6\">' + '<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>' + '<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>' + '<numFmt numFmtId=\"166\" formatCode=\"[$€-2]\\ #,##0.00\"/>' + '<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>' + '<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>' + '<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>' + '</numFmts>' + '<fonts count=\"5\" x14ac:knownFonts=\"1\">' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<color rgb=\"FFFFFFFF\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<b />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<i />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<u />' + '</font>' + '</fonts>' + '<fills count=\"6\">' + '<fill>' + '<patternFill patternType=\"none\" />' + '</fill>' + '<fill>' + // Excel appears to use this as a dotted background regardless of values but\n    '<patternFill patternType=\"none\" />' + // to be valid to the schema, use a patternFill\n    '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD9D9D9\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD99795\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6efce\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6cfef\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '</fills>' + '<borders count=\"2\">' + '<border>' + '<left />' + '<right />' + '<top />' + '<bottom />' + '<diagonal />' + '</border>' + '<border diagonalUp=\"false\" diagonalDown=\"false\">' + '<left style=\"thin\">' + '<color auto=\"1\" />' + '</left>' + '<right style=\"thin\">' + '<color auto=\"1\" />' + '</right>' + '<top style=\"thin\">' + '<color auto=\"1\" />' + '</top>' + '<bottom style=\"thin\">' + '<color auto=\"1\" />' + '</bottom>' + '<diagonal />' + '</border>' + '</borders>' + '<cellStyleXfs count=\"1\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />' + '</cellStyleXfs>' + '<cellXfs count=\"68\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"left\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"center\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"right\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"fill\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment textRotation=\"90\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment wrapText=\"1\"/>' + '</xf>' + '<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"1\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"2\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '<xf numFmtId=\"14\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>' + '</cellXfs>' + '<cellStyles count=\"1\">' + '<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />' + '</cellStyles>' + '<dxfs count=\"0\" />' + '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />' + '</styleSheet>'\n  }; // Note we could use 3 `for` loops for the styles, but when gzipped there is\n  // virtually no difference in size, since the above can be easily compressed\n  // Pattern matching for special number formats. Perhaps this should be exposed\n  // via an API in future?\n  // Ref: section 3.8.30 - built in formatters in open spreadsheet\n  //   https://www.ecma-international.org/news/TC45_current_work/Office%20Open%20XML%20Part%204%20-%20Markup%20Language%20Reference.pdf\n\n  var _excelSpecials = [{\n    match: /^\\-?\\d+\\.\\d%$/,\n    style: 60,\n    fmt: function (d) {\n      return d / 100;\n    }\n  }, // Precent with d.p.\n  {\n    match: /^\\-?\\d+\\.?\\d*%$/,\n    style: 56,\n    fmt: function (d) {\n      return d / 100;\n    }\n  }, // Percent\n  {\n    match: /^\\-?\\$[\\d,]+.?\\d*$/,\n    style: 57\n  }, // Dollars\n  {\n    match: /^\\-?£[\\d,]+.?\\d*$/,\n    style: 58\n  }, // Pounds\n  {\n    match: /^\\-?€[\\d,]+.?\\d*$/,\n    style: 59\n  }, // Euros\n  {\n    match: /^\\-?\\d+$/,\n    style: 65\n  }, // Numbers without thousand separators\n  {\n    match: /^\\-?\\d+\\.\\d{2}$/,\n    style: 66\n  }, // Numbers 2 d.p. without thousands separators\n  {\n    match: /^\\([\\d,]+\\)$/,\n    style: 61,\n    fmt: function (d) {\n      return -1 * d.replace(/[\\(\\)]/g, '');\n    }\n  }, // Negative numbers indicated by brackets\n  {\n    match: /^\\([\\d,]+\\.\\d{2}\\)$/,\n    style: 62,\n    fmt: function (d) {\n      return -1 * d.replace(/[\\(\\)]/g, '');\n    }\n  }, // Negative numbers indicated by brackets - 2d.p.\n  {\n    match: /^\\-?[\\d,]+$/,\n    style: 63\n  }, // Numbers with thousand separators\n  {\n    match: /^\\-?[\\d,]+\\.\\d{2}$/,\n    style: 64\n  }, {\n    match: /^[\\d]{4}\\-[\\d]{2}\\-[\\d]{2}$/,\n    style: 67,\n    fmt: function (d) {\n      return Math.round(25569 + Date.parse(d) / (86400 * 1000));\n    }\n  } //Date yyyy-mm-dd\n  ];\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * Buttons\n   */\n  //\n  // Copy to clipboard\n  //\n\n  DataTable.ext.buttons.copyHtml5 = {\n    className: 'buttons-copy buttons-html5',\n    text: function (dt) {\n      return dt.i18n('buttons.copy', 'Copy');\n    },\n    action: function (e, dt, button, config) {\n      this.processing(true);\n      var that = this;\n\n      var exportData = _exportData(dt, config);\n\n      var info = dt.buttons.exportInfo(config);\n\n      var newline = _newLine(config);\n\n      var output = exportData.str;\n      var hiddenDiv = $('<div/>').css({\n        height: 1,\n        width: 1,\n        overflow: 'hidden',\n        position: 'fixed',\n        top: 0,\n        left: 0\n      });\n\n      if (info.title) {\n        output = info.title + newline + newline + output;\n      }\n\n      if (info.messageTop) {\n        output = info.messageTop + newline + newline + output;\n      }\n\n      if (info.messageBottom) {\n        output = output + newline + newline + info.messageBottom;\n      }\n\n      if (config.customize) {\n        output = config.customize(output, config, dt);\n      }\n\n      var textarea = $('<textarea readonly/>').val(output).appendTo(hiddenDiv); // For browsers that support the copy execCommand, try to use it\n\n      if (document.queryCommandSupported('copy')) {\n        hiddenDiv.appendTo(dt.table().container());\n        textarea[0].focus();\n        textarea[0].select();\n\n        try {\n          var successful = document.execCommand('copy');\n          hiddenDiv.remove();\n\n          if (successful) {\n            dt.buttons.info(dt.i18n('buttons.copyTitle', 'Copy to clipboard'), dt.i18n('buttons.copySuccess', {\n              1: 'Copied one row to clipboard',\n              _: 'Copied %d rows to clipboard'\n            }, exportData.rows), 2000);\n            this.processing(false);\n            return;\n          }\n        } catch (t) {}\n      } // Otherwise we show the text box and instruct the user to use it\n\n\n      var message = $('<span>' + dt.i18n('buttons.copyKeys', 'Press <i>ctrl</i> or <i>\\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>' + 'To cancel, click this message or press escape.') + '</span>').append(hiddenDiv);\n      dt.buttons.info(dt.i18n('buttons.copyTitle', 'Copy to clipboard'), message, 0); // Select the text so when the user activates their system clipboard\n      // it will copy that text\n\n      textarea[0].focus();\n      textarea[0].select(); // Event to hide the message when the user is done\n\n      var container = $(message).closest('.dt-button-info');\n\n      var close = function () {\n        container.off('click.buttons-copy');\n        $(document).off('.buttons-copy');\n        dt.buttons.info(false);\n      };\n\n      container.on('click.buttons-copy', close);\n      $(document).on('keydown.buttons-copy', function (e) {\n        if (e.keyCode === 27) {\n          // esc\n          close();\n          that.processing(false);\n        }\n      }).on('copy.buttons-copy cut.buttons-copy', function () {\n        close();\n        that.processing(false);\n      });\n    },\n    exportOptions: {},\n    fieldSeparator: '\\t',\n    fieldBoundary: '',\n    header: true,\n    footer: false,\n    title: '*',\n    messageTop: '*',\n    messageBottom: '*'\n  }; //\n  // CSV export\n  //\n\n  DataTable.ext.buttons.csvHtml5 = {\n    bom: false,\n    className: 'buttons-csv buttons-html5',\n    available: function () {\n      return window.FileReader !== undefined && window.Blob;\n    },\n    text: function (dt) {\n      return dt.i18n('buttons.csv', 'CSV');\n    },\n    action: function (e, dt, button, config) {\n      this.processing(true); // Set the text\n\n      var output = _exportData(dt, config).str;\n\n      var info = dt.buttons.exportInfo(config);\n      var charset = config.charset;\n\n      if (config.customize) {\n        output = config.customize(output, config, dt);\n      }\n\n      if (charset !== false) {\n        if (!charset) {\n          charset = document.characterSet || document.charset;\n        }\n\n        if (charset) {\n          charset = ';charset=' + charset;\n        }\n      } else {\n        charset = '';\n      }\n\n      if (config.bom) {\n        output = String.fromCharCode(0xFEFF) + output;\n      }\n\n      _saveAs(new Blob([output], {\n        type: 'text/csv' + charset\n      }), info.filename, true);\n\n      this.processing(false);\n    },\n    filename: '*',\n    extension: '.csv',\n    exportOptions: {},\n    fieldSeparator: ',',\n    fieldBoundary: '\"',\n    escapeChar: '\"',\n    charset: null,\n    header: true,\n    footer: false\n  }; //\n  // Excel (xlsx) export\n  //\n\n  DataTable.ext.buttons.excelHtml5 = {\n    className: 'buttons-excel buttons-html5',\n    available: function () {\n      return window.FileReader !== undefined && _jsZip() !== undefined && !_isDuffSafari() && _serialiser;\n    },\n    text: function (dt) {\n      return dt.i18n('buttons.excel', 'Excel');\n    },\n    action: function (e, dt, button, config) {\n      this.processing(true);\n      var that = this;\n      var rowPos = 0;\n      var dataStartRow, dataEndRow;\n\n      var getXml = function (type) {\n        var str = excelStrings[type]; //str = str.replace( /xmlns:/g, 'xmlns_' ).replace( /mc:/g, 'mc_' );\n\n        return $.parseXML(str);\n      };\n\n      var rels = getXml('xl/worksheets/sheet1.xml');\n      var relsGet = rels.getElementsByTagName(\"sheetData\")[0];\n      var xlsx = {\n        _rels: {\n          \".rels\": getXml('_rels/.rels')\n        },\n        xl: {\n          _rels: {\n            \"workbook.xml.rels\": getXml('xl/_rels/workbook.xml.rels')\n          },\n          \"workbook.xml\": getXml('xl/workbook.xml'),\n          \"styles.xml\": getXml('xl/styles.xml'),\n          \"worksheets\": {\n            \"sheet1.xml\": rels\n          }\n        },\n        \"[Content_Types].xml\": getXml('[Content_Types].xml')\n      };\n      var data = dt.buttons.exportData(config.exportOptions);\n      var currentRow, rowNode;\n\n      var addRow = function (row) {\n        currentRow = rowPos + 1;\n        rowNode = _createNode(rels, \"row\", {\n          attr: {\n            r: currentRow\n          }\n        });\n\n        for (var i = 0, ien = row.length; i < ien; i++) {\n          // Concat both the Cell Columns as a letter and the Row of the cell.\n          var cellId = createCellPos(i) + '' + currentRow;\n          var cell = null; // For null, undefined of blank cell, continue so it doesn't create the _createNode\n\n          if (row[i] === null || row[i] === undefined || row[i] === '') {\n            if (config.createEmptyCells === true) {\n              row[i] = '';\n            } else {\n              continue;\n            }\n          }\n\n          var originalContent = row[i];\n          row[i] = typeof row[i].trim === 'function' ? row[i].trim() : row[i]; // Special number formatting options\n\n          for (var j = 0, jen = _excelSpecials.length; j < jen; j++) {\n            var special = _excelSpecials[j]; // TODO Need to provide the ability for the specials to say\n            // if they are returning a string, since at the moment it is\n            // assumed to be a number\n\n            if (row[i].match && !row[i].match(/^0\\d+/) && row[i].match(special.match)) {\n              var val = row[i].replace(/[^\\d\\.\\-]/g, '');\n\n              if (special.fmt) {\n                val = special.fmt(val);\n              }\n\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  r: cellId,\n                  s: special.style\n                },\n                children: [_createNode(rels, 'v', {\n                  text: val\n                })]\n              });\n              break;\n            }\n          }\n\n          if (!cell) {\n            if (typeof row[i] === 'number' || row[i].match && row[i].match(/^-?\\d+(\\.\\d+)?$/) && !row[i].match(/^0\\d+/)) {\n              // Detect numbers - don't match numbers with leading zeros\n              // or a negative anywhere but the start\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  t: 'n',\n                  r: cellId\n                },\n                children: [_createNode(rels, 'v', {\n                  text: row[i]\n                })]\n              });\n            } else {\n              // String output - replace non standard characters for text output\n              var text = !originalContent.replace ? originalContent : originalContent.replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n              cell = _createNode(rels, 'c', {\n                attr: {\n                  t: 'inlineStr',\n                  r: cellId\n                },\n                children: {\n                  row: _createNode(rels, 'is', {\n                    children: {\n                      row: _createNode(rels, 't', {\n                        text: text,\n                        attr: {\n                          'xml:space': 'preserve'\n                        }\n                      })\n                    }\n                  })\n                }\n              });\n            }\n          }\n\n          rowNode.appendChild(cell);\n        }\n\n        relsGet.appendChild(rowNode);\n        rowPos++;\n      };\n\n      if (config.customizeData) {\n        config.customizeData(data);\n      }\n\n      var mergeCells = function (row, colspan) {\n        var mergeCells = $('mergeCells', rels);\n        mergeCells[0].appendChild(_createNode(rels, 'mergeCell', {\n          attr: {\n            ref: 'A' + row + ':' + createCellPos(colspan) + row\n          }\n        }));\n        mergeCells.attr('count', parseFloat(mergeCells.attr('count')) + 1);\n        $('row:eq(' + (row - 1) + ') c', rels).attr('s', '51'); // centre\n      }; // Title and top messages\n\n\n      var exportInfo = dt.buttons.exportInfo(config);\n\n      if (exportInfo.title) {\n        addRow([exportInfo.title], rowPos);\n        mergeCells(rowPos, data.header.length - 1);\n      }\n\n      if (exportInfo.messageTop) {\n        addRow([exportInfo.messageTop], rowPos);\n        mergeCells(rowPos, data.header.length - 1);\n      } // Table itself\n\n\n      if (config.header) {\n        addRow(data.header, rowPos);\n        $('row:last c', rels).attr('s', '2'); // bold\n      }\n\n      dataStartRow = rowPos;\n\n      for (var n = 0, ie = data.body.length; n < ie; n++) {\n        addRow(data.body[n], rowPos);\n      }\n\n      dataEndRow = rowPos;\n\n      if (config.footer && data.footer) {\n        addRow(data.footer, rowPos);\n        $('row:last c', rels).attr('s', '2'); // bold\n      } // Below the table\n\n\n      if (exportInfo.messageBottom) {\n        addRow([exportInfo.messageBottom], rowPos);\n        mergeCells(rowPos, data.header.length - 1);\n      } // Set column widths\n\n\n      var cols = _createNode(rels, 'cols');\n\n      $('worksheet', rels).prepend(cols);\n\n      for (var i = 0, ien = data.header.length; i < ien; i++) {\n        cols.appendChild(_createNode(rels, 'col', {\n          attr: {\n            min: i + 1,\n            max: i + 1,\n            width: _excelColWidth(data, i),\n            customWidth: 1\n          }\n        }));\n      } // Workbook modifications\n\n\n      var workbook = xlsx.xl['workbook.xml'];\n      $('sheets sheet', workbook).attr('name', _sheetname(config)); // Auto filter for columns\n\n      if (config.autoFilter) {\n        $('mergeCells', rels).before(_createNode(rels, 'autoFilter', {\n          attr: {\n            ref: 'A' + dataStartRow + ':' + createCellPos(data.header.length - 1) + dataEndRow\n          }\n        }));\n        $('definedNames', workbook).append(_createNode(workbook, 'definedName', {\n          attr: {\n            name: '_xlnm._FilterDatabase',\n            localSheetId: '0',\n            hidden: 1\n          },\n          text: _sheetname(config) + '!$A$' + dataStartRow + ':' + createCellPos(data.header.length - 1) + dataEndRow\n        }));\n      } // Let the developer customise the document if they want to\n\n\n      if (config.customize) {\n        config.customize(xlsx, config, dt);\n      } // Excel doesn't like an empty mergeCells tag\n\n\n      if ($('mergeCells', rels).children().length === 0) {\n        $('mergeCells', rels).remove();\n      }\n\n      var jszip = _jsZip();\n\n      var zip = new jszip();\n      var zipConfig = {\n        type: 'blob',\n        mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n      };\n\n      _addToZip(zip, xlsx);\n\n      if (zip.generateAsync) {\n        // JSZip 3+\n        zip.generateAsync(zipConfig).then(function (blob) {\n          _saveAs(blob, exportInfo.filename);\n\n          that.processing(false);\n        });\n      } else {\n        // JSZip 2.5\n        _saveAs(zip.generate(zipConfig), exportInfo.filename);\n\n        this.processing(false);\n      }\n    },\n    filename: '*',\n    extension: '.xlsx',\n    exportOptions: {},\n    header: true,\n    footer: false,\n    title: '*',\n    messageTop: '*',\n    messageBottom: '*',\n    createEmptyCells: false,\n    autoFilter: false,\n    sheetName: ''\n  }; //\n  // PDF export - using pdfMake - http://pdfmake.org\n  //\n\n  DataTable.ext.buttons.pdfHtml5 = {\n    className: 'buttons-pdf buttons-html5',\n    available: function () {\n      return window.FileReader !== undefined && _pdfMake();\n    },\n    text: function (dt) {\n      return dt.i18n('buttons.pdf', 'PDF');\n    },\n    action: function (e, dt, button, config) {\n      this.processing(true);\n      var that = this;\n      var data = dt.buttons.exportData(config.exportOptions);\n      var info = dt.buttons.exportInfo(config);\n      var rows = [];\n\n      if (config.header) {\n        rows.push($.map(data.header, function (d) {\n          return {\n            text: typeof d === 'string' ? d : d + '',\n            style: 'tableHeader'\n          };\n        }));\n      }\n\n      for (var i = 0, ien = data.body.length; i < ien; i++) {\n        rows.push($.map(data.body[i], function (d) {\n          if (d === null || d === undefined) {\n            d = '';\n          }\n\n          return {\n            text: typeof d === 'string' ? d : d + '',\n            style: i % 2 ? 'tableBodyEven' : 'tableBodyOdd'\n          };\n        }));\n      }\n\n      if (config.footer && data.footer) {\n        rows.push($.map(data.footer, function (d) {\n          return {\n            text: typeof d === 'string' ? d : d + '',\n            style: 'tableFooter'\n          };\n        }));\n      }\n\n      var doc = {\n        pageSize: config.pageSize,\n        pageOrientation: config.orientation,\n        content: [{\n          table: {\n            headerRows: 1,\n            body: rows\n          },\n          layout: 'noBorders'\n        }],\n        styles: {\n          tableHeader: {\n            bold: true,\n            fontSize: 11,\n            color: 'white',\n            fillColor: '#2d4154',\n            alignment: 'center'\n          },\n          tableBodyEven: {},\n          tableBodyOdd: {\n            fillColor: '#f3f3f3'\n          },\n          tableFooter: {\n            bold: true,\n            fontSize: 11,\n            color: 'white',\n            fillColor: '#2d4154'\n          },\n          title: {\n            alignment: 'center',\n            fontSize: 15\n          },\n          message: {}\n        },\n        defaultStyle: {\n          fontSize: 10\n        }\n      };\n\n      if (info.messageTop) {\n        doc.content.unshift({\n          text: info.messageTop,\n          style: 'message',\n          margin: [0, 0, 0, 12]\n        });\n      }\n\n      if (info.messageBottom) {\n        doc.content.push({\n          text: info.messageBottom,\n          style: 'message',\n          margin: [0, 0, 0, 12]\n        });\n      }\n\n      if (info.title) {\n        doc.content.unshift({\n          text: info.title,\n          style: 'title',\n          margin: [0, 0, 0, 12]\n        });\n      }\n\n      if (config.customize) {\n        config.customize(doc, config, dt);\n      }\n\n      var pdf = _pdfMake().createPdf(doc);\n\n      if (config.download === 'open' && !_isDuffSafari()) {\n        pdf.open();\n      } else {\n        pdf.download(info.filename);\n      }\n\n      this.processing(false);\n    },\n    title: '*',\n    filename: '*',\n    extension: '.pdf',\n    exportOptions: {},\n    orientation: 'portrait',\n    pageSize: 'A4',\n    header: true,\n    footer: false,\n    messageTop: '*',\n    messageBottom: '*',\n    customize: null,\n    download: 'download'\n  };\n  return DataTable.Buttons;\n});","map":{"version":3,"names":["factory","define","amd","$","window","document","exports","module","root","jszip","pdfmake","fn","dataTable","require","Buttons","jQuery","undefined","DataTable","_jsZip","JSZip","_pdfMake","pdfMake","_","_saveAs","view","navigator","test","userAgent","doc","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","click","node","event","MouseEvent","dispatchEvent","is_safari","HTMLElement","safari","is_chrome_ios","throw_outside","ex","setImmediate","setTimeout","force_saveable_type","arbitrary_revoke_timeout","revoke","file","revoker","revokeObjectURL","remove","dispatch","filesaver","event_types","concat","i","length","listener","call","auto_bom","blob","type","Blob","String","fromCharCode","FileSaver","name","no_auto_bom","force","object_url","dispatch_all","split","fs_error","FileReader","reader","onloadend","url","result","replace","popup","open","location","href","readyState","DONE","readAsDataURL","INIT","createObjectURL","opened","download","FS_proto","prototype","saveAs","msSaveOrOpenBlob","abort","WRITING","error","onwritestart","onprogress","onwrite","onabort","onerror","onwriteend","self","content","fileSave","_sheetname","config","sheetName","_newLine","newline","match","_exportData","dt","newLine","data","buttons","exportData","exportOptions","boundary","fieldBoundary","separator","fieldSeparator","reBoundary","RegExp","escapeChar","join","a","s","ien","header","footer","body","push","str","rows","_isDuffSafari","indexOf","version","createCellPos","n","ordA","charCodeAt","ordZ","len","Math","floor","_serialiser","XMLSerializer","_ieExcel","t","_addToZip","zip","obj","serializeToString","DOMParser","parseFromString","excelStrings","each","val","isPlainObject","newDir","folder","worksheet","childNodes","attrs","attributes","attrName","nodeName","attrValue","nodeValue","value","removeAttribute","attr","createAttribute","setAttributeNode","_createNode","opts","tempNode","createElement","children","key","appendChild","text","createTextNode","_excelColWidth","col","max","lineSplit","point","toString","sort","b","_excelSpecials","style","fmt","d","round","Date","parse","ext","copyHtml5","className","i18n","action","e","button","processing","that","info","exportInfo","output","hiddenDiv","css","height","width","overflow","position","top","left","title","messageTop","messageBottom","customize","textarea","appendTo","queryCommandSupported","table","container","focus","select","successful","execCommand","message","append","closest","close","off","on","keyCode","csvHtml5","bom","available","charset","characterSet","filename","extension","excelHtml5","rowPos","dataStartRow","dataEndRow","getXml","parseXML","rels","relsGet","getElementsByTagName","xlsx","_rels","xl","currentRow","rowNode","addRow","row","r","cellId","cell","createEmptyCells","originalContent","trim","j","jen","special","customizeData","mergeCells","colspan","ref","parseFloat","ie","cols","prepend","min","customWidth","workbook","autoFilter","before","localSheetId","hidden","zipConfig","mimeType","generateAsync","then","generate","pdfHtml5","map","pageSize","pageOrientation","orientation","headerRows","layout","styles","tableHeader","bold","fontSize","color","fillColor","alignment","tableBodyEven","tableBodyOdd","tableFooter","defaultStyle","unshift","margin","pdf","createPdf"],"sources":["D:/PFCJACOBO/PFC/mycinemalist/node_modules/datatables.net-buttons/js/buttons.html5.js"],"sourcesContent":["/*!\n * HTML5 export buttons for Buttons and DataTables.\n * 2016 SpryMedia Ltd - datatables.net/license\n *\n * FileSaver.js (1.3.3) - MIT license\n * Copyright © 2016 Eli Grey - http://eligrey.com\n */\n\n(function( factory ){\n\tif ( typeof define === 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine( ['jquery', 'datatables.net', 'datatables.net-buttons'], function ( $ ) {\n\t\t\treturn factory( $, window, document );\n\t\t} );\n\t}\n\telse if ( typeof exports === 'object' ) {\n\t\t// CommonJS\n\t\tmodule.exports = function (root, $, jszip, pdfmake) {\n\t\t\tif ( ! root ) {\n\t\t\t\troot = window;\n\t\t\t}\n\n\t\t\tif ( ! $ || ! $.fn.dataTable ) {\n\t\t\t\t$ = require('datatables.net')(root, $).$;\n\t\t\t}\n\n\t\t\tif ( ! $.fn.dataTable.Buttons ) {\n\t\t\t\trequire('datatables.net-buttons')(root, $);\n\t\t\t}\n\n\t\t\treturn factory( $, root, root.document, jszip, pdfmake );\n\t\t};\n\t}\n\telse {\n\t\t// Browser\n\t\tfactory( jQuery, window, document );\n\t}\n}(function( $, window, document, jszip, pdfmake, undefined ) {\n'use strict';\nvar DataTable = $.fn.dataTable;\n\n// Allow the constructor to pass in JSZip and PDFMake from external requires.\n// Otherwise, use globally defined variables, if they are available.\nfunction _jsZip () {\n\treturn jszip || window.JSZip;\n}\nfunction _pdfMake () {\n\treturn pdfmake || window.pdfMake;\n}\n\nDataTable.Buttons.pdfMake = function (_) {\n\tif ( ! _ ) {\n\t\treturn _pdfMake();\n\t}\n\tpdfmake = _;\n}\n\nDataTable.Buttons.jszip = function (_) {\n\tif ( ! _ ) {\n\t\treturn _jsZip();\n\t}\n\tjszip = _;\n}\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * FileSaver.js dependency\n */\n\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\nvar _saveAs = (function(view) {\n\t\"use strict\";\n\t// IE <10 is explicitly unsupported\n\tif (typeof view === \"undefined\" || typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n\t\treturn;\n\t}\n\tvar\n\t\t  doc = view.document\n\t\t  // only get URL when necessary in case Blob.js hasn't overridden it yet\n\t\t, get_URL = function() {\n\t\t\treturn view.URL || view.webkitURL || view;\n\t\t}\n\t\t, save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n\t\t, can_use_save_link = \"download\" in save_link\n\t\t, click = function(node) {\n\t\t\tvar event = new MouseEvent(\"click\");\n\t\t\tnode.dispatchEvent(event);\n\t\t}\n\t\t, is_safari = /constructor/i.test(view.HTMLElement) || view.safari\n\t\t, is_chrome_ios =/CriOS\\/[\\d]+/.test(navigator.userAgent)\n\t\t, throw_outside = function(ex) {\n\t\t\t(view.setImmediate || view.setTimeout)(function() {\n\t\t\t\tthrow ex;\n\t\t\t}, 0);\n\t\t}\n\t\t, force_saveable_type = \"application/octet-stream\"\n\t\t// the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n\t\t, arbitrary_revoke_timeout = 1000 * 40 // in ms\n\t\t, revoke = function(file) {\n\t\t\tvar revoker = function() {\n\t\t\t\tif (typeof file === \"string\") { // file is an object URL\n\t\t\t\t\tget_URL().revokeObjectURL(file);\n\t\t\t\t} else { // file is a File\n\t\t\t\t\tfile.remove();\n\t\t\t\t}\n\t\t\t};\n\t\t\tsetTimeout(revoker, arbitrary_revoke_timeout);\n\t\t}\n\t\t, dispatch = function(filesaver, event_types, event) {\n\t\t\tevent_types = [].concat(event_types);\n\t\t\tvar i = event_types.length;\n\t\t\twhile (i--) {\n\t\t\t\tvar listener = filesaver[\"on\" + event_types[i]];\n\t\t\t\tif (typeof listener === \"function\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tthrow_outside(ex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t, auto_bom = function(blob) {\n\t\t\t// prepend BOM for UTF-8 XML and text/* types (including HTML)\n\t\t\t// note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n\t\t\tif (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n\t\t\t\treturn new Blob([String.fromCharCode(0xFEFF), blob], {type: blob.type});\n\t\t\t}\n\t\t\treturn blob;\n\t\t}\n\t\t, FileSaver = function(blob, name, no_auto_bom) {\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\t// First try a.download, then web filesystem, then object URLs\n\t\t\tvar\n\t\t\t\t  filesaver = this\n\t\t\t\t, type = blob.type\n\t\t\t\t, force = type === force_saveable_type\n\t\t\t\t, object_url\n\t\t\t\t, dispatch_all = function() {\n\t\t\t\t\tdispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n\t\t\t\t}\n\t\t\t\t// on any filesys errors revert to saving with object URLs\n\t\t\t\t, fs_error = function() {\n\t\t\t\t\tif ((is_chrome_ios || (force && is_safari)) && view.FileReader) {\n\t\t\t\t\t\t// Safari doesn't allow downloading of blob urls\n\t\t\t\t\t\tvar reader = new FileReader();\n\t\t\t\t\t\treader.onloadend = function() {\n\t\t\t\t\t\t\tvar url = is_chrome_ios ? reader.result : reader.result.replace(/^data:[^;]*;/, 'data:attachment/file;');\n\t\t\t\t\t\t\tvar popup = view.open(url, '_blank');\n\t\t\t\t\t\t\tif(!popup) view.location.href = url;\n\t\t\t\t\t\t\turl=undefined; // release reference before dispatching\n\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\tdispatch_all();\n\t\t\t\t\t\t};\n\t\t\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\t\t\tfilesaver.readyState = filesaver.INIT;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// don't create more object URLs than needed\n\t\t\t\t\tif (!object_url) {\n\t\t\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\t\t}\n\t\t\t\t\tif (force) {\n\t\t\t\t\t\tview.location.href = object_url;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar opened = view.open(object_url, \"_blank\");\n\t\t\t\t\t\tif (!opened) {\n\t\t\t\t\t\t\t// Apple does not allow window.open, see https://developer.apple.com/library/safari/documentation/Tools/Conceptual/SafariExtensionGuide/WorkingwithWindowsandTabs/WorkingwithWindowsandTabs.html\n\t\t\t\t\t\t\tview.location.href = object_url;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t}\n\t\t\t;\n\t\t\tfilesaver.readyState = filesaver.INIT;\n\n\t\t\tif (can_use_save_link) {\n\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tsave_link.href = object_url;\n\t\t\t\t\tsave_link.download = name;\n\t\t\t\t\tclick(save_link);\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfs_error();\n\t\t}\n\t\t, FS_proto = FileSaver.prototype\n\t\t, saveAs = function(blob, name, no_auto_bom) {\n\t\t\treturn new FileSaver(blob, name || blob.name || \"download\", no_auto_bom);\n\t\t}\n\t;\n\t// IE 10+ (native saveAs)\n\tif (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n\t\treturn function(blob, name, no_auto_bom) {\n\t\t\tname = name || blob.name || \"download\";\n\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name);\n\t\t};\n\t}\n\n\tFS_proto.abort = function(){};\n\tFS_proto.readyState = FS_proto.INIT = 0;\n\tFS_proto.WRITING = 1;\n\tFS_proto.DONE = 2;\n\n\tFS_proto.error =\n\tFS_proto.onwritestart =\n\tFS_proto.onprogress =\n\tFS_proto.onwrite =\n\tFS_proto.onabort =\n\tFS_proto.onerror =\n\tFS_proto.onwriteend =\n\t\tnull;\n\n\treturn saveAs;\n}(\n\t   typeof self !== \"undefined\" && self\n\t|| typeof window !== \"undefined\" && window\n\t|| this.content\n));\n\n\n// Expose file saver on the DataTables API. Can't attach to `DataTables.Buttons`\n// since this file can be loaded before Button's core!\nDataTable.fileSave = _saveAs;\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Local (private) functions\n */\n\n/**\n * Get the sheet name for Excel exports.\n *\n * @param {object}\tconfig Button configuration\n */\nvar _sheetname = function ( config )\n{\n\tvar sheetName = 'Sheet1';\n\n\tif ( config.sheetName ) {\n\t\tsheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n\t}\n\n\treturn sheetName;\n};\n\n/**\n * Get the newline character(s)\n *\n * @param {object}\tconfig Button configuration\n * @return {string}\t\t\t\tNewline character\n */\nvar _newLine = function ( config )\n{\n\treturn config.newline ?\n\t\tconfig.newline :\n\t\tnavigator.userAgent.match(/Windows/) ?\n\t\t\t'\\r\\n' :\n\t\t\t'\\n';\n};\n\n/**\n * Combine the data from the `buttons.exportData` method into a string that\n * will be used in the export file.\n *\n * @param\t{DataTable.Api} dt\t\t DataTables API instance\n * @param\t{object}\t\t\t\tconfig Button configuration\n * @return {object}\t\t\t\t\t\t\t The data to export\n */\nvar _exportData = function ( dt, config )\n{\n\tvar newLine = _newLine( config );\n\tvar data = dt.buttons.exportData( config.exportOptions );\n\tvar boundary = config.fieldBoundary;\n\tvar separator = config.fieldSeparator;\n\tvar reBoundary = new RegExp( boundary, 'g' );\n\tvar escapeChar = config.escapeChar !== undefined ?\n\t\tconfig.escapeChar :\n\t\t'\\\\';\n\tvar join = function ( a ) {\n\t\tvar s = '';\n\n\t\t// If there is a field boundary, then we might need to escape it in\n\t\t// the source data\n\t\tfor ( var i=0, ien=a.length ; i<ien ; i++ ) {\n\t\t\tif ( i > 0 ) {\n\t\t\t\ts += separator;\n\t\t\t}\n\n\t\t\ts += boundary ?\n\t\t\t\tboundary + ('' + a[i]).replace( reBoundary, escapeChar+boundary ) + boundary :\n\t\t\t\ta[i];\n\t\t}\n\n\t\treturn s;\n\t};\n\n\tvar header = config.header ? join( data.header )+newLine : '';\n\tvar footer = config.footer && data.footer ? newLine+join( data.footer ) : '';\n\tvar body = [];\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tbody.push( join( data.body[i] ) );\n\t}\n\n\treturn {\n\t\tstr: header + body.join( newLine ) + footer,\n\t\trows: body.length\n\t};\n};\n\n/**\n * Older versions of Safari (prior to tech preview 18) don't support the\n * download option required.\n *\n * @return {Boolean} `true` if old Safari\n */\nvar _isDuffSafari = function ()\n{\n\tvar safari = navigator.userAgent.indexOf('Safari') !== -1 &&\n\t\tnavigator.userAgent.indexOf('Chrome') === -1 &&\n\t\tnavigator.userAgent.indexOf('Opera') === -1;\n\n\tif ( ! safari ) {\n\t\treturn false;\n\t}\n\n\tvar version = navigator.userAgent.match( /AppleWebKit\\/(\\d+\\.\\d+)/ );\n\tif ( version && version.length > 1 && version[1]*1 < 603.1 ) {\n\t\treturn true;\n\t}\n\n\treturn false;\n};\n\n/**\n * Convert from numeric position to letter for column names in Excel\n * @param  {int} n Column number\n * @return {string} Column letter(s) name\n */\nfunction createCellPos( n ){\n\tvar ordA = 'A'.charCodeAt(0);\n\tvar ordZ = 'Z'.charCodeAt(0);\n\tvar len = ordZ - ordA + 1;\n\tvar s = \"\";\n\n\twhile( n >= 0 ) {\n\t\ts = String.fromCharCode(n % len + ordA) + s;\n\t\tn = Math.floor(n / len) - 1;\n\t}\n\n\treturn s;\n}\n\ntry {\n\tvar _serialiser = new XMLSerializer();\n\tvar _ieExcel;\n}\ncatch (t) {}\n\n/**\n * Recursively add XML files from an object's structure to a ZIP file. This\n * allows the XSLX file to be easily defined with an object's structure matching\n * the files structure.\n *\n * @param {JSZip} zip ZIP package\n * @param {object} obj Object to add (recursive)\n */\nfunction _addToZip( zip, obj ) {\n\tif ( _ieExcel === undefined ) {\n\t\t// Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n\t\t// drop attributes\n\t\t_ieExcel = _serialiser\n\t\t\t.serializeToString(\n\t\t\t\t( new window.DOMParser() ).parseFromString( excelStrings['xl/worksheets/sheet1.xml'], 'text/xml' )\n\t\t\t)\n\t\t\t.indexOf( 'xmlns:r' ) === -1;\n\t}\n\n\t$.each( obj, function ( name, val ) {\n\t\tif ( $.isPlainObject( val ) ) {\n\t\t\tvar newDir = zip.folder( name );\n\t\t\t_addToZip( newDir, val );\n\t\t}\n\t\telse {\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE's XML serialiser will drop some name space attributes from\n\t\t\t\t// from the root node, so we need to save them. Do this by\n\t\t\t\t// replacing the namespace nodes with a regular attribute that\n\t\t\t\t// we convert back when serialised. Edge does not have this\n\t\t\t\t// issue\n\t\t\t\tvar worksheet = val.childNodes[0];\n\t\t\t\tvar i, ien;\n\t\t\t\tvar attrs = [];\n\n\t\t\t\tfor ( i=worksheet.attributes.length-1 ; i>=0 ; i-- ) {\n\t\t\t\t\tvar attrName = worksheet.attributes[i].nodeName;\n\t\t\t\t\tvar attrValue = worksheet.attributes[i].nodeValue;\n\n\t\t\t\t\tif ( attrName.indexOf( ':' ) !== -1 ) {\n\t\t\t\t\t\tattrs.push( { name: attrName, value: attrValue } );\n\n\t\t\t\t\t\tworksheet.removeAttribute( attrName );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor ( i=0, ien=attrs.length ; i<ien ; i++ ) {\n\t\t\t\t\tvar attr = val.createAttribute( attrs[i].name.replace( ':', '_dt_b_namespace_token_' ) );\n\t\t\t\t\tattr.value = attrs[i].value;\n\t\t\t\t\tworksheet.setAttributeNode( attr );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar str = _serialiser.serializeToString(val);\n\n\t\t\t// Fix IE's XML\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE doesn't include the XML declaration\n\t\t\t\tif ( str.indexOf( '<?xml' ) === -1 ) {\n\t\t\t\t\tstr = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+str;\n\t\t\t\t}\n\n\t\t\t\t// Return namespace attributes to being as such\n\t\t\t\tstr = str.replace( /_dt_b_namespace_token_/g, ':' );\n\n\t\t\t\t// Remove testing name space that IE puts into the space preserve attr\n\t\t\t\tstr = str.replace( /xmlns:NS[\\d]+=\"\" NS[\\d]+:/g, '' );\n\t\t\t}\n\n\t\t\t// Safari, IE and Edge will put empty name space attributes onto\n\t\t\t// various elements making them useless. This strips them out\n\t\t\tstr = str.replace( /<([^<>]*?) xmlns=\"\"([^<>]*?)>/g, '<$1 $2>' );\n\n\t\t\tzip.file( name, str );\n\t\t}\n\t} );\n}\n\n/**\n * Create an XML node and add any children, attributes, etc without needing to\n * be verbose in the DOM.\n *\n * @param  {object} doc      XML document\n * @param  {string} nodeName Node name\n * @param  {object} opts     Options - can be `attr` (attributes), `children`\n *   (child nodes) and `text` (text content)\n * @return {node}            Created node\n */\nfunction _createNode( doc, nodeName, opts ) {\n\tvar tempNode = doc.createElement( nodeName );\n\n\tif ( opts ) {\n\t\tif ( opts.attr ) {\n\t\t\t$(tempNode).attr( opts.attr );\n\t\t}\n\n\t\tif ( opts.children ) {\n\t\t\t$.each( opts.children, function ( key, value ) {\n\t\t\t\ttempNode.appendChild( value );\n\t\t\t} );\n\t\t}\n\n\t\tif ( opts.text !== null && opts.text !== undefined ) {\n\t\t\ttempNode.appendChild( doc.createTextNode( opts.text ) );\n\t\t}\n\t}\n\n\treturn tempNode;\n}\n\n/**\n * Get the width for an Excel column based on the contents of that column\n * @param  {object} data Data for export\n * @param  {int}    col  Column index\n * @return {int}         Column width\n */\nfunction _excelColWidth( data, col ) {\n\tvar max = data.header[col].length;\n\tvar len, lineSplit, str;\n\n\tif ( data.footer && data.footer[col].length > max ) {\n\t\tmax = data.footer[col].length;\n\t}\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tvar point = data.body[i][col];\n\t\tstr = point !== null && point !== undefined ?\n\t\t\tpoint.toString() :\n\t\t\t'';\n\n\t\t// If there is a newline character, workout the width of the column\n\t\t// based on the longest line in the string\n\t\tif ( str.indexOf('\\n') !== -1 ) {\n\t\t\tlineSplit = str.split('\\n');\n\t\t\tlineSplit.sort( function (a, b) {\n\t\t\t\treturn b.length - a.length;\n\t\t\t} );\n\n\t\t\tlen = lineSplit[0].length;\n\t\t}\n\t\telse {\n\t\t\tlen = str.length;\n\t\t}\n\n\t\tif ( len > max ) {\n\t\t\tmax = len;\n\t\t}\n\n\t\t// Max width rather than having potentially massive column widths\n\t\tif ( max > 40 ) {\n\t\t\treturn 54; // 40 * 1.35\n\t\t}\n\t}\n\n\tmax *= 1.35;\n\n\t// And a min width\n\treturn max > 6 ? max : 6;\n}\n\n// Excel - Pre-defined strings to build a basic XLSX file\nvar excelStrings = {\n\t\"_rels/.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"xl/_rels/workbook.xml.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>'+\n\t\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"[Content_Types].xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'+\n\t\t\t'<Default Extension=\"xml\" ContentType=\"application/xml\" />'+\n\t\t\t'<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />'+\n\t\t\t'<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />'+\n\t\t\t'<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />'+\n\t\t'</Types>',\n\n\t\"xl/workbook.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">'+\n\t\t\t'<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>'+\n\t\t\t'<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>'+\n\t\t\t'<bookViews>'+\n\t\t\t\t'<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>'+\n\t\t\t'</bookViews>'+\n\t\t\t'<sheets>'+\n\t\t\t\t'<sheet name=\"Sheet1\" sheetId=\"1\" r:id=\"rId1\"/>'+\n\t\t\t'</sheets>'+\n\t\t\t'<definedNames/>'+\n\t\t'</workbook>',\n\n\t\"xl/worksheets/sheet1.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<sheetData/>'+\n\t\t\t'<mergeCells count=\"0\"/>'+\n\t\t'</worksheet>',\n\n\t\"xl/styles.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?>'+\n\t\t'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<numFmts count=\"6\">'+\n\t\t\t\t'<numFmt numFmtId=\"164\" formatCode=\"#,##0.00_-\\ [$$-45C]\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"165\" formatCode=\"&quot;£&quot;#,##0.00\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"166\" formatCode=\"[$€-2]\\ #,##0.00\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"167\" formatCode=\"0.0%\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"168\" formatCode=\"#,##0;(#,##0)\"/>'+\n\t\t\t\t'<numFmt numFmtId=\"169\" formatCode=\"#,##0.00;(#,##0.00)\"/>'+\n\t\t\t'</numFmts>'+\n\t\t\t'<fonts count=\"5\" x14ac:knownFonts=\"1\">'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<color rgb=\"FFFFFFFF\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<b />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<i />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<u />'+\n\t\t\t\t'</font>'+\n\t\t\t'</fonts>'+\n\t\t\t'<fills count=\"6\">'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+ // Excel appears to use this as a dotted background regardless of values but\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+ // to be valid to the schema, use a patternFill\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD9D9D9\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD99795\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6efce\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6cfef\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t'</fills>'+\n\t\t\t'<borders count=\"2\">'+\n\t\t\t\t'<border>'+\n\t\t\t\t\t'<left />'+\n\t\t\t\t\t'<right />'+\n\t\t\t\t\t'<top />'+\n\t\t\t\t\t'<bottom />'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t\t'<border diagonalUp=\"false\" diagonalDown=\"false\">'+\n\t\t\t\t\t'<left style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</left>'+\n\t\t\t\t\t'<right style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</right>'+\n\t\t\t\t\t'<top style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</top>'+\n\t\t\t\t\t'<bottom style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</bottom>'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t'</borders>'+\n\t\t\t'<cellStyleXfs count=\"1\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />'+\n\t\t\t'</cellStyleXfs>'+\n\t\t\t'<cellXfs count=\"68\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"left\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"center\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"right\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"fill\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment textRotation=\"90\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment wrapText=\"1\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"9\"   fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"164\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"165\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"166\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"167\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"168\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"169\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"3\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"4\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"1\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"2\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"14\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyNumberFormat=\"1\"/>'+\n\t\t\t'</cellXfs>'+\n\t\t\t'<cellStyles count=\"1\">'+\n\t\t\t\t'<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />'+\n\t\t\t'</cellStyles>'+\n\t\t\t'<dxfs count=\"0\" />'+\n\t\t\t'<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />'+\n\t\t'</styleSheet>'\n};\n// Note we could use 3 `for` loops for the styles, but when gzipped there is\n// virtually no difference in size, since the above can be easily compressed\n\n// Pattern matching for special number formats. Perhaps this should be exposed\n// via an API in future?\n// Ref: section 3.8.30 - built in formatters in open spreadsheet\n//   https://www.ecma-international.org/news/TC45_current_work/Office%20Open%20XML%20Part%204%20-%20Markup%20Language%20Reference.pdf\nvar _excelSpecials = [\n\t{ match: /^\\-?\\d+\\.\\d%$/,               style: 60, fmt: function (d) { return d/100; } }, // Precent with d.p.\n\t{ match: /^\\-?\\d+\\.?\\d*%$/,             style: 56, fmt: function (d) { return d/100; } }, // Percent\n\t{ match: /^\\-?\\$[\\d,]+.?\\d*$/,          style: 57 }, // Dollars\n\t{ match: /^\\-?£[\\d,]+.?\\d*$/,           style: 58 }, // Pounds\n\t{ match: /^\\-?€[\\d,]+.?\\d*$/,           style: 59 }, // Euros\n\t{ match: /^\\-?\\d+$/,                    style: 65 }, // Numbers without thousand separators\n\t{ match: /^\\-?\\d+\\.\\d{2}$/,             style: 66 }, // Numbers 2 d.p. without thousands separators\n\t{ match: /^\\([\\d,]+\\)$/,                style: 61, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets\n\t{ match: /^\\([\\d,]+\\.\\d{2}\\)$/,         style: 62, fmt: function (d) { return -1 * d.replace(/[\\(\\)]/g, ''); } },  // Negative numbers indicated by brackets - 2d.p.\n\t{ match: /^\\-?[\\d,]+$/,                 style: 63 }, // Numbers with thousand separators\n\t{ match: /^\\-?[\\d,]+\\.\\d{2}$/,          style: 64 },\n\t{ match: /^[\\d]{4}\\-[\\d]{2}\\-[\\d]{2}$/, style: 67, fmt: function (d) {return Math.round(25569 + (Date.parse(d) / (86400 * 1000)));}} //Date yyyy-mm-dd\n];\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Buttons\n */\n\n//\n// Copy to clipboard\n//\nDataTable.ext.buttons.copyHtml5 = {\n\tclassName: 'buttons-copy buttons-html5',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.copy', 'Copy' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\tvar that = this;\n\t\tvar exportData = _exportData( dt, config );\n\t\tvar info = dt.buttons.exportInfo( config );\n\t\tvar newline = _newLine(config);\n\t\tvar output = exportData.str;\n\t\tvar hiddenDiv = $('<div/>')\n\t\t\t.css( {\n\t\t\t\theight: 1,\n\t\t\t\twidth: 1,\n\t\t\t\toverflow: 'hidden',\n\t\t\t\tposition: 'fixed',\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t} );\n\n\t\tif ( info.title ) {\n\t\t\toutput = info.title + newline + newline + output;\n\t\t}\n\n\t\tif ( info.messageTop ) {\n\t\t\toutput = info.messageTop + newline + newline + output;\n\t\t}\n\n\t\tif ( info.messageBottom ) {\n\t\t\toutput = output + newline + newline + info.messageBottom;\n\t\t}\n\n\t\tif ( config.customize ) {\n\t\t\toutput = config.customize( output, config, dt );\n\t\t}\n\n\t\tvar textarea = $('<textarea readonly/>')\n\t\t\t.val( output )\n\t\t\t.appendTo( hiddenDiv );\n\n\t\t// For browsers that support the copy execCommand, try to use it\n\t\tif ( document.queryCommandSupported('copy') ) {\n\t\t\thiddenDiv.appendTo( dt.table().container() );\n\t\t\ttextarea[0].focus();\n\t\t\ttextarea[0].select();\n\n\t\t\ttry {\n\t\t\t\tvar successful = document.execCommand( 'copy' );\n\t\t\t\thiddenDiv.remove();\n\n\t\t\t\tif (successful) {\n\t\t\t\t\tdt.buttons.info(\n\t\t\t\t\t\tdt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ),\n\t\t\t\t\t\tdt.i18n( 'buttons.copySuccess', {\n\t\t\t\t\t\t\t1: 'Copied one row to clipboard',\n\t\t\t\t\t\t\t_: 'Copied %d rows to clipboard'\n\t\t\t\t\t\t}, exportData.rows ),\n\t\t\t\t\t\t2000\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.processing( false );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (t) {}\n\t\t}\n\n\t\t// Otherwise we show the text box and instruct the user to use it\n\t\tvar message = $('<span>'+dt.i18n( 'buttons.copyKeys',\n\t\t\t\t'Press <i>ctrl</i> or <i>\\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>'+\n\t\t\t\t'To cancel, click this message or press escape.' )+'</span>'\n\t\t\t)\n\t\t\t.append( hiddenDiv );\n\n\t\tdt.buttons.info( dt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ), message, 0 );\n\n\t\t// Select the text so when the user activates their system clipboard\n\t\t// it will copy that text\n\t\ttextarea[0].focus();\n\t\ttextarea[0].select();\n\n\t\t// Event to hide the message when the user is done\n\t\tvar container = $(message).closest('.dt-button-info');\n\t\tvar close = function () {\n\t\t\tcontainer.off( 'click.buttons-copy' );\n\t\t\t$(document).off( '.buttons-copy' );\n\t\t\tdt.buttons.info( false );\n\t\t};\n\n\t\tcontainer.on( 'click.buttons-copy', close );\n\t\t$(document)\n\t\t\t.on( 'keydown.buttons-copy', function (e) {\n\t\t\t\tif ( e.keyCode === 27 ) { // esc\n\t\t\t\t\tclose();\n\t\t\t\t\tthat.processing( false );\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.on( 'copy.buttons-copy cut.buttons-copy', function () {\n\t\t\t\tclose();\n\t\t\t\tthat.processing( false );\n\t\t\t} );\n\t},\n\n\texportOptions: {},\n\n\tfieldSeparator: '\\t',\n\n\tfieldBoundary: '',\n\n\theader: true,\n\n\tfooter: false,\n\n\ttitle: '*',\n\n\tmessageTop: '*',\n\n\tmessageBottom: '*'\n};\n\n//\n// CSV export\n//\nDataTable.ext.buttons.csvHtml5 = {\n\tbom: false,\n\n\tclassName: 'buttons-csv buttons-html5',\n\n\tavailable: function () {\n\t\treturn window.FileReader !== undefined && window.Blob;\n\t},\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.csv', 'CSV' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\t// Set the text\n\t\tvar output = _exportData( dt, config ).str;\n\t\tvar info = dt.buttons.exportInfo(config);\n\t\tvar charset = config.charset;\n\n\t\tif ( config.customize ) {\n\t\t\toutput = config.customize( output, config, dt );\n\t\t}\n\n\t\tif ( charset !== false ) {\n\t\t\tif ( ! charset ) {\n\t\t\t\tcharset = document.characterSet || document.charset;\n\t\t\t}\n\n\t\t\tif ( charset ) {\n\t\t\t\tcharset = ';charset='+charset;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tcharset = '';\n\t\t}\n\n\t\tif ( config.bom ) {\n\t\t\toutput = String.fromCharCode(0xFEFF) + output;\n\t\t}\n\n\t\t_saveAs(\n\t\t\tnew Blob( [output], {type: 'text/csv'+charset} ),\n\t\t\tinfo.filename,\n\t\t\ttrue\n\t\t);\n\n\t\tthis.processing( false );\n\t},\n\n\tfilename: '*',\n\n\textension: '.csv',\n\n\texportOptions: {},\n\n\tfieldSeparator: ',',\n\n\tfieldBoundary: '\"',\n\n\tescapeChar: '\"',\n\n\tcharset: null,\n\n\theader: true,\n\n\tfooter: false\n};\n\n//\n// Excel (xlsx) export\n//\nDataTable.ext.buttons.excelHtml5 = {\n\tclassName: 'buttons-excel buttons-html5',\n\n\tavailable: function () {\n\t\treturn window.FileReader !== undefined && _jsZip() !== undefined && ! _isDuffSafari() && _serialiser;\n\t},\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.excel', 'Excel' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\tvar that = this;\n\t\tvar rowPos = 0;\n\t\tvar dataStartRow, dataEndRow;\n\t\tvar getXml = function ( type ) {\n\t\t\tvar str = excelStrings[ type ];\n\n\t\t\t//str = str.replace( /xmlns:/g, 'xmlns_' ).replace( /mc:/g, 'mc_' );\n\n\t\t\treturn $.parseXML( str );\n\t\t};\n\t\tvar rels = getXml('xl/worksheets/sheet1.xml');\n\t\tvar relsGet = rels.getElementsByTagName( \"sheetData\" )[0];\n\n\t\tvar xlsx = {\n\t\t\t_rels: {\n\t\t\t\t\".rels\": getXml('_rels/.rels')\n\t\t\t},\n\t\t\txl: {\n\t\t\t\t_rels: {\n\t\t\t\t\t\"workbook.xml.rels\": getXml('xl/_rels/workbook.xml.rels')\n\t\t\t\t},\n\t\t\t\t\"workbook.xml\": getXml('xl/workbook.xml'),\n\t\t\t\t\"styles.xml\": getXml('xl/styles.xml'),\n\t\t\t\t\"worksheets\": {\n\t\t\t\t\t\"sheet1.xml\": rels\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t\"[Content_Types].xml\": getXml('[Content_Types].xml')\n\t\t};\n\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar currentRow, rowNode;\n\t\tvar addRow = function ( row ) {\n\t\t\tcurrentRow = rowPos+1;\n\t\t\trowNode = _createNode( rels, \"row\", { attr: {r:currentRow} } );\n\n\t\t\tfor ( var i=0, ien=row.length ; i<ien ; i++ ) {\n\t\t\t\t// Concat both the Cell Columns as a letter and the Row of the cell.\n\t\t\t\tvar cellId = createCellPos(i) + '' + currentRow;\n\t\t\t\tvar cell = null;\n\n\t\t\t\t// For null, undefined of blank cell, continue so it doesn't create the _createNode\n\t\t\t\tif ( row[i] === null || row[i] === undefined || row[i] === '' ) {\n\t\t\t\t\tif ( config.createEmptyCells === true ) {\n\t\t\t\t\t\trow[i] = '';\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar originalContent = row[i];\n\t\t\t\trow[i] = typeof row[i].trim === 'function'\n\t\t\t\t\t? row[i].trim()\n\t\t\t\t\t: row[i];\n\n\t\t\t\t// Special number formatting options\n\t\t\t\tfor ( var j=0, jen=_excelSpecials.length ; j<jen ; j++ ) {\n\t\t\t\t\tvar special = _excelSpecials[j];\n\n\t\t\t\t\t// TODO Need to provide the ability for the specials to say\n\t\t\t\t\t// if they are returning a string, since at the moment it is\n\t\t\t\t\t// assumed to be a number\n\t\t\t\t\tif ( row[i].match && ! row[i].match(/^0\\d+/) && row[i].match( special.match ) ) {\n\t\t\t\t\t\tvar val = row[i].replace(/[^\\d\\.\\-]/g, '');\n\n\t\t\t\t\t\tif ( special.fmt ) {\n\t\t\t\t\t\t\tval = special.fmt( val );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tr: cellId,\n\t\t\t\t\t\t\t\ts: special.style\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: val } )\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( ! cell ) {\n\t\t\t\t\tif ( typeof row[i] === 'number' || (\n\t\t\t\t\t\trow[i].match &&\n\t\t\t\t\t\trow[i].match(/^-?\\d+(\\.\\d+)?$/) &&\n\t\t\t\t\t\t! row[i].match(/^0\\d+/) )\n\t\t\t\t\t) {\n\t\t\t\t\t\t// Detect numbers - don't match numbers with leading zeros\n\t\t\t\t\t\t// or a negative anywhere but the start\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tt: 'n',\n\t\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\t_createNode( rels, 'v', { text: row[i] } )\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// String output - replace non standard characters for text output\n\t\t\t\t\t\tvar text = ! originalContent.replace ?\n\t\t\t\t\t\t\toriginalContent :\n\t\t\t\t\t\t\toriginalContent.replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n\n\t\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\tt: 'inlineStr',\n\t\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren:{\n\t\t\t\t\t\t\t\trow: _createNode( rels, 'is', {\n\t\t\t\t\t\t\t\t\tchildren: {\n\t\t\t\t\t\t\t\t\t\trow: _createNode( rels, 't', {\n\t\t\t\t\t\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\t\t\t\t\t\t'xml:space': 'preserve'\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\trowNode.appendChild( cell );\n\t\t\t}\n\n\t\t\trelsGet.appendChild(rowNode);\n\t\t\trowPos++;\n\t\t};\n\n\t\tif ( config.customizeData ) {\n\t\t\tconfig.customizeData( data );\n\t\t}\n\n\t\tvar mergeCells = function ( row, colspan ) {\n\t\t\tvar mergeCells = $('mergeCells', rels);\n\n\t\t\tmergeCells[0].appendChild( _createNode( rels, 'mergeCell', {\n\t\t\t\tattr: {\n\t\t\t\t\tref: 'A'+row+':'+createCellPos(colspan)+row\n\t\t\t\t}\n\t\t\t} ) );\n\t\t\tmergeCells.attr( 'count', parseFloat(mergeCells.attr( 'count' ))+1 );\n\t\t\t$('row:eq('+(row-1)+') c', rels).attr( 's', '51' ); // centre\n\t\t};\n\n\t\t// Title and top messages\n\t\tvar exportInfo = dt.buttons.exportInfo( config );\n\t\tif ( exportInfo.title ) {\n\t\t\taddRow( [exportInfo.title], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\t\tif ( exportInfo.messageTop ) {\n\t\t\taddRow( [exportInfo.messageTop], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\n\t\t// Table itself\n\t\tif ( config.header ) {\n\t\t\taddRow( data.header, rowPos );\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\n\t\t}\n\t\n\t\tdataStartRow = rowPos;\n\n\t\tfor ( var n=0, ie=data.body.length ; n<ie ; n++ ) {\n\t\t\taddRow( data.body[n], rowPos );\n\t\t}\n\t\n\t\tdataEndRow = rowPos;\n\n\t\tif ( config.footer && data.footer ) {\n\t\t\taddRow( data.footer, rowPos);\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\t// Below the table\n\t\tif ( exportInfo.messageBottom ) {\n\t\t\taddRow( [exportInfo.messageBottom], rowPos );\n\t\t\tmergeCells( rowPos, data.header.length-1 );\n\t\t}\n\n\t\t// Set column widths\n\t\tvar cols = _createNode( rels, 'cols' );\n\t\t$('worksheet', rels).prepend( cols );\n\n\t\tfor ( var i=0, ien=data.header.length ; i<ien ; i++ ) {\n\t\t\tcols.appendChild( _createNode( rels, 'col', {\n\t\t\t\tattr: {\n\t\t\t\t\tmin: i+1,\n\t\t\t\t\tmax: i+1,\n\t\t\t\t\twidth: _excelColWidth( data, i ),\n\t\t\t\t\tcustomWidth: 1\n\t\t\t\t}\n\t\t\t} ) );\n\t\t}\n\n\t\t// Workbook modifications\n\t\tvar workbook = xlsx.xl['workbook.xml'];\n\n\t\t$( 'sheets sheet', workbook ).attr( 'name', _sheetname( config ) );\n\n\t\t// Auto filter for columns\n\t\tif ( config.autoFilter ) {\n\t\t\t$('mergeCells', rels).before( _createNode( rels, 'autoFilter', {\n\t\t\t\tattr: {\n\t\t\t\t\tref: 'A'+dataStartRow+':'+createCellPos(data.header.length-1)+dataEndRow\n\t\t\t\t}\n\t\t\t} ) );\n\n\t\t\t$('definedNames', workbook).append( _createNode( workbook, 'definedName', {\n\t\t\t\tattr: {\n\t\t\t\t\tname: '_xlnm._FilterDatabase',\n\t\t\t\t\tlocalSheetId: '0',\n\t\t\t\t\thidden: 1\n\t\t\t\t},\n\t\t\t\ttext: _sheetname(config)+'!$A$'+dataStartRow+':'+createCellPos(data.header.length-1)+dataEndRow\n\t\t\t} ) );\n\t\t}\n\n\t\t// Let the developer customise the document if they want to\n\t\tif ( config.customize ) {\n\t\t\tconfig.customize( xlsx, config, dt );\n\t\t}\n\n\t\t// Excel doesn't like an empty mergeCells tag\n\t\tif ( $('mergeCells', rels).children().length === 0 ) {\n\t\t\t$('mergeCells', rels).remove();\n\t\t}\n\n\t\tvar jszip = _jsZip();\n\t\tvar zip = new jszip();\n\t\tvar zipConfig = {\n\t\t\ttype: 'blob',\n\t\t\tmimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n\t\t};\n\n\t\t_addToZip( zip, xlsx );\n\n\t\tif ( zip.generateAsync ) {\n\t\t\t// JSZip 3+\n\t\t\tzip\n\t\t\t\t.generateAsync( zipConfig )\n\t\t\t\t.then( function ( blob ) {\n\t\t\t\t\t_saveAs( blob, exportInfo.filename );\n\t\t\t\t\tthat.processing( false );\n\t\t\t\t} );\n\t\t}\n\t\telse {\n\t\t\t// JSZip 2.5\n\t\t\t_saveAs(\n\t\t\t\tzip.generate( zipConfig ),\n\t\t\t\texportInfo.filename\n\t\t\t);\n\t\t\tthis.processing( false );\n\t\t}\n\t},\n\n\tfilename: '*',\n\n\textension: '.xlsx',\n\n\texportOptions: {},\n\n\theader: true,\n\n\tfooter: false,\n\n\ttitle: '*',\n\n\tmessageTop: '*',\n\n\tmessageBottom: '*',\n\n\tcreateEmptyCells: false,\n\n\tautoFilter: false,\n\n\tsheetName: ''\n};\n\n//\n// PDF export - using pdfMake - http://pdfmake.org\n//\nDataTable.ext.buttons.pdfHtml5 = {\n\tclassName: 'buttons-pdf buttons-html5',\n\n\tavailable: function () {\n\t\treturn window.FileReader !== undefined && _pdfMake();\n\t},\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.pdf', 'PDF' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tthis.processing( true );\n\n\t\tvar that = this;\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar info = dt.buttons.exportInfo( config );\n\t\tvar rows = [];\n\n\t\tif ( config.header ) {\n\t\t\trows.push( $.map( data.header, function ( d ) {\n\t\t\t\treturn {\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\n\t\t\t\t\tstyle: 'tableHeader'\n\t\t\t\t};\n\t\t\t} ) );\n\t\t}\n\n\t\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\t\trows.push( $.map( data.body[i], function ( d ) {\n\t\t\t\tif ( d === null || d === undefined ) {\n\t\t\t\t\td = '';\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\n\t\t\t\t\tstyle: i % 2 ? 'tableBodyEven' : 'tableBodyOdd'\n\t\t\t\t};\n\t\t\t} ) );\n\t\t}\n\n\t\tif ( config.footer && data.footer) {\n\t\t\trows.push( $.map( data.footer, function ( d ) {\n\t\t\t\treturn {\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\n\t\t\t\t\tstyle: 'tableFooter'\n\t\t\t\t};\n\t\t\t} ) );\n\t\t}\n\n\t\tvar doc = {\n\t\t\tpageSize: config.pageSize,\n\t\t\tpageOrientation: config.orientation,\n\t\t\tcontent: [\n\t\t\t\t{\n\t\t\t\t\ttable: {\n\t\t\t\t\t\theaderRows: 1,\n\t\t\t\t\t\tbody: rows\n\t\t\t\t\t},\n\t\t\t\t\tlayout: 'noBorders'\n\t\t\t\t}\n\t\t\t],\n\t\t\tstyles: {\n\t\t\t\ttableHeader: {\n\t\t\t\t\tbold: true,\n\t\t\t\t\tfontSize: 11,\n\t\t\t\t\tcolor: 'white',\n\t\t\t\t\tfillColor: '#2d4154',\n\t\t\t\t\talignment: 'center'\n\t\t\t\t},\n\t\t\t\ttableBodyEven: {},\n\t\t\t\ttableBodyOdd: {\n\t\t\t\t\tfillColor: '#f3f3f3'\n\t\t\t\t},\n\t\t\t\ttableFooter: {\n\t\t\t\t\tbold: true,\n\t\t\t\t\tfontSize: 11,\n\t\t\t\t\tcolor: 'white',\n\t\t\t\t\tfillColor: '#2d4154'\n\t\t\t\t},\n\t\t\t\ttitle: {\n\t\t\t\t\talignment: 'center',\n\t\t\t\t\tfontSize: 15\n\t\t\t\t},\n\t\t\t\tmessage: {}\n\t\t\t},\n\t\t\tdefaultStyle: {\n\t\t\t\tfontSize: 10\n\t\t\t}\n\t\t};\n\n\t\tif ( info.messageTop ) {\n\t\t\tdoc.content.unshift( {\n\t\t\t\ttext: info.messageTop,\n\t\t\t\tstyle: 'message',\n\t\t\t\tmargin: [ 0, 0, 0, 12 ]\n\t\t\t} );\n\t\t}\n\n\t\tif ( info.messageBottom ) {\n\t\t\tdoc.content.push( {\n\t\t\t\ttext: info.messageBottom,\n\t\t\t\tstyle: 'message',\n\t\t\t\tmargin: [ 0, 0, 0, 12 ]\n\t\t\t} );\n\t\t}\n\n\t\tif ( info.title ) {\n\t\t\tdoc.content.unshift( {\n\t\t\t\ttext: info.title,\n\t\t\t\tstyle: 'title',\n\t\t\t\tmargin: [ 0, 0, 0, 12 ]\n\t\t\t} );\n\t\t}\n\n\t\tif ( config.customize ) {\n\t\t\tconfig.customize( doc, config, dt );\n\t\t}\n\n\t\tvar pdf = _pdfMake().createPdf( doc );\n\n\t\tif ( config.download === 'open' && ! _isDuffSafari() ) {\n\t\t\tpdf.open();\n\t\t}\n\t\telse {\n\t\t\tpdf.download( info.filename );\n\t\t}\n\n\t\tthis.processing( false );\n\t},\n\n\ttitle: '*',\n\n\tfilename: '*',\n\n\textension: '.pdf',\n\n\texportOptions: {},\n\n\torientation: 'portrait',\n\n\tpageSize: 'A4',\n\n\theader: true,\n\n\tfooter: false,\n\n\tmessageTop: '*',\n\n\tmessageBottom: '*',\n\n\tcustomize: null,\n\n\tdownload: 'download'\n};\n\n\nreturn DataTable.Buttons;\n}));\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}